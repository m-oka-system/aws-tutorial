# SQLiteのインストールに失敗する。

## エラー内容

An error occurred while installing sqlite3 (1.3.13), and Bundler cannot
continue.

## 解決方法

sudo yum install sqlite-devel -y

または、

Gemfileからsqlite3を削除（コメントアウト）

# bundle installで権限がなくて失敗する。

## エラー内容

There was an error while trying to write to
`/var/www/rails/Association_tutorial/Gemfile.lock`. It is likely that you need
to grant write permissions for that path.

## 解決方法

sudo chown -R ec2-user Association_tutorial

# Railsがインストールされない

しかも、bundlerのインストールからやり直さないとgem installでも入らない。

## エラー内容

## 解決方法

gem install bundler
gem install rails -v 5.1.6.1

# rake db:migrateが失敗する

## エラー内容

Devise.secret_key was not set. Please add the following to your Devise initializer:

## 解決方法

sudo vim config/initializers/devise.rb
config.secret_key = 'secret_key'
を追記

（参考URL)
https://www.papa-programing.jp/entry/2016/08/09/231500


# Unicornが起動していない

## エラー内容

ブラウザでアクセスしてもページが見つかりません

## 解決方法

log/unicorn.logで判明
#secret_key
export SECRET_KEY_BASE="c204bdf7e4b4c22a9d1d472e6266892d6ea6dd91633a61732c850ad2418cbefae830fedf4419a77befae4525b1995905e6094830467776e35730fcd93a3b127e"
source ~/.bashrc
source ~/.bash_profile

#unicorn起動
unicorn_rails -c /var/www/rails/Association_tutorial/config/unicorn.conf.rb -D -E production


# TOPページが開けない

* エラー内容

ブラウザでアクセスすると
We're sorry, but something went wrong.

production.logで判明
ActionView::Template::Error (The asset "application.css" is not present in the asset pipeline.): と出力

##  解決方法

rake assets:precompile RAILS_ENV=production
⇨Download Yarn at https://yarnpkg.com/en/docs/install　と言われる。

sudo npm install yarn -g
⇨Node version 0.10.48 is not supported, please use Node.js 4.0 or higher. と言われる。

curl --silent --location https://rpm.nodesource.com/setup_8.x | sudo bash -
sudo yum -y install nodejs
⇨transaction check error　と言われる。

以下の手順で解決。
```
# nodejsを削除
sudo yum remove nodejs npm

# nodejs 8系をインストール
curl --silent --location https://rpm.nodesource.com/setup_8.x | sudo bash -
sudo yum -y install nodejs

# プリコンパイル
rake assets:precompile RAILS_ENV=production

# unicorn起動
unicorn_rails -c /var/www/rails/Association_tutorial/config/unicorn.conf.rb -D -E production

# nginxリロード
sudo nginx -s reload
```

#＃ RDSに対して、rake db:migrate が通らない

* エラー内容

Mysql2::Error::ConnectionError: Access denied for user 'root'@'10.0.11.61' (using password: NO)

* 解決方法

エクスクラメーションマーク(!)から始まるパスワードはNG

https://stackoverflow.com/questions/21719738/rails-and-mysql2-access-denied-for-user-rootlocalhost-using-password-no

環境変数を反映

source ~/.bash_profile
printenv
